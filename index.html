<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#0b1020" />
  <title>RiverLog</title>

  <!-- PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <!-- Favicons -->
  <link rel="icon" type="image/png" href="assets/favicon.png" sizes="any" />

  <!-- iOS Home Screen Icon -->
  <link rel="apple-touch-icon" href="data:image/png;base64,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" />

  <!-- Styles -->
  <link rel="stylesheet" href="app.css?v=57" />
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">
        <img src="data:image/png;base64,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" alt="RiverLog" />
      </div>

      <div>
        <div class="title">RiverLog</div>
        <div class="subtitle">Quick catch log (offline-first)</div>
      </div>
    </div>

    <div class="actions">
      <button id="installBtn" class="btn ghost" hidden>Install</button>
      <button id="exportBtn" class="btn" type="button">Export</button>
      <label class="btn ghost fileBtn">
        Import
        <input id="importInput" type="file" accept="application/zip,application/json,.zip,.json" hidden />
      </label>
    </div>
  </header>

  <main class="wrap">
    <!-- TRIP (open) -->
    <section class="card">
      <div class="row">
        <div class="grow">
          <label class="label">Trip</label>
          <div class="row gap">
            <select id="tripSelect" class="input"></select>
            <button id="newTripBtn" class="btn ghost" type="button">New</button>
            <button id="editTripBtn" class="btn ghost" type="button">Edit</button>
            <button id="deleteTripBtn" class="btn ghost danger" type="button">Delete</button>
          </div>
          <div class="hint">Tip: make a new trip at the river. Later you’ll add recap + “Fly that won the day” on your Mac.</div>
        </div>

        <div class="stat">
          <div class="statNum" id="catchCount">0</div>
          <div class="statLbl">Catches</div>
        </div>
      </div>

      <div class="divider"></div>

      <div class="grid2">
        <div>
          <label class="label">Species</label>
          <select id="species" class="input">
            <option value="">—</option>

            <!-- Core Trout -->
            <option>Rainbow Trout</option>
            <option>Brown Trout</option>
            <option>Brook Trout</option>
            <option>Lake Trout</option>
            <option>Cutthroat Trout</option>
            <option>Golden Trout</option>

            <!-- Cutthroat Subspecies -->
            <option>Coastal Cutthroat Trout</option>
            <option>Westslope Cutthroat Trout</option>
            <option>Yellowstone Cutthroat Trout</option>
            <option>Lahontan Cutthroat Trout</option>
            <option>Bonneville Cutthroat Trout</option>
            <option>Greenback Cutthroat Trout</option>
            <option>Rio Grande Cutthroat Trout</option>
            <option>Bear River Cutthroat Trout</option>
            <option>Colorado River Cutthroat Trout</option>
            <option>Snake River Fine-spotted Cutthroat Trout</option>

            <!-- Char (often grouped as trout by anglers) -->
            <option>Brook Trout (Char)</option>
            <option>Bull Trout</option>
            <option>Dolly Varden</option>
            <option>Arctic Char</option>

            <!-- Salmon / Sea-Run Trout -->
            <option>Steelhead</option>
            <option>Atlantic Salmon</option>

            <!-- Hybrids -->
            <option>Tiger Trout</option>
            <option>Splake</option>
            <option>Cutbow Trout</option>

            <!-- Bass / Other (keep existing structure intact) -->
            <option>Smallmouth Bass</option>
            <option>Largemouth Bass</option>
            <option>Salmon (Pacific)</option>
            <option>Other</option>
          </select>
        </div>

        <div>
          <label class="label">Fly</label>
          <input id="fly" class="input" placeholder="e.g., Elk Hair Caddis" />
        </div>

        <div>
          <label class="label">Length (optional)</label>
          <input id="length" class="input" inputmode="decimal" placeholder="inches" />
        </div>

        <div>
          <label class="label">Notes (optional)</label>
          <input id="notes" class="input" placeholder="quick detail" />
        </div>
      </div>

      <div class="row gap topGap">
        <label class="btn fileBtn">
          Capture Photo
          <!-- ONE button: OS chooser includes Camera + Library -->
          <input id="photoInput" type="file" accept="image/*" multiple hidden />
        </label>
        <button id="gpsBtn" class="btn ghost" type="button">Add GPS (optional)</button>
        <button id="saveCatchBtn" class="btn accent" type="button">Save Catch</button>
      </div>

      <div class="hint" id="gpsHint">GPS: not added</div>
      <div class="hint" id="photoHint">Photo: none</div>
    </section>

    <!-- CATCHES (collapsed by default) -->
    <section class="card">
      <details class="collapse" id="catchesCollapse">
        <summary class="collapseSummary">
          Catches
          <span class="muted" id="catchesSummaryMeta"></span>
        </summary>

        <div class="divider"></div>

        <div id="catchList" class="list"></div>
        <div id="emptyState" class="empty">
          No catches yet. Log your first one above.
        </div>
      </details>
    </section>

    <!-- QUIVER (FlyBox, collapsed by default) -->
    <section class="card">
      <details class="collapse" id="flyBoxCollapse">
        <summary class="collapseSummary">
          Quiver
          <span class="muted" id="flyBoxSummaryMeta" style="margin-left:8px;"></span>
        </summary>

        <div class="divider"></div>

        <div class="row">
          <div class="grow">
            <div class="row gap">
              <select id="flyBoxSelect" class="input"></select>
              <button id="newFlyBoxBtn" class="btn ghost" type="button">New</button>
              <button id="editFlyBoxBtn" class="btn ghost" type="button">Edit</button>
              <button id="deleteFlyBoxBtn" class="btn ghost danger" type="button">Delete</button>
            </div>
          </div>

          <div class="stat">
            <div class="statNum" id="flyCount">0</div>
            <div class="statLbl">Flies</div>
          </div>
        </div>

        <div class="divider"></div>

        <div class="row between center topGap metapad">
          <div class="subtitle2" id="flyBoxMeta">—</div>
          <button id="openFlyModalBtn" class="btn accent" type="button">Add Fly</button>
        </div>

        <div id="flyList" class="list"></div>
        <div id="flyEmpty" class="empty">
          No flies yet. Tap “Add Fly” to add your first pattern.
        </div>
      </details>
    </section>

    <!-- BADGES + INSIGHTS (collapsed by default) -->
    <section class="card">
      <details class="collapse" id="badgesCollapse">
        <summary class="collapseSummary">
          Badges + Insights <span class="muted" style="margin-left:8px;">(milestones + quick stats)</span>
        </summary>

        <div class="divider"></div>

        <!-- 3-up tiles (placeholders for now) -->
        <div class="grid3" id="insightTiles">
          <div class="insightTile">
            <div class="label">Personal Record</div>
            <div class="insightPhoto" id="prTile">
              <div class="insightPhotoPlaceholder">No record yet</div>
            </div>
            <div class="muted" id="prSub">—</div>
          </div>

          <div class="insightTile">
            <div class="label">Best Used Fly</div>
            <div class="insightBig" id="topFlyTile">—</div>
            <div class="muted" id="topFlySub">—</div>
          </div>

          <div class="insightTile">
            <div class="label">Top Species</div>
            <div class="insightBig" id="topSpeciesTile">—</div>
            <div class="muted" id="topSpeciesSub">—</div>
          </div>
        </div>

        <div class="divider"></div>

        <div id="badgeGrid" class="badgeGrid"></div>
      </details>
    </section>

    <!-- TRIP RECAP (collapsed by default) -->
    <section class="card">
      <details class="collapse" id="tripRecapCollapse">
        <summary class="collapseSummary">
          Trip Recap <span class="muted" style="margin-left:8px;">(notes + winner fly)</span>
        </summary>

        <div class="divider"></div>

        <div class="row gap topGap">
          <button id="collageBtn" class="btn" type="button">Build Collage</button>
          <button id="collageBtnTop9" class="btn ghost" type="button">Build Top 9 Collage</button>
        </div>
        <div class="hint">Build a post-trip collage from your catch photos (sorted by length), or preview the top 9.</div>

        <div class="divider"></div>

        <div class="grid2">
          <div>
            <label class="label">Trip Name</label>
            <input id="tripName" class="input" placeholder="e.g., Upper Delaware – Jan 15" />
          </div>
          <div>
            <label class="label">Trip Date</label>
            <input id="tripDate" class="input" type="date" />
          </div>
          <div>
            <label class="label">Location (optional)</label>
            <input id="tripLocation" class="input" placeholder="river / section" />
          </div>
          <div>
            <label class="label">Trip note (optional)</label>
            <input id="tripDesc" class="input" placeholder="who/what/conditions" />
          </div>
          <div>
            <label class="label">Fly that won the day</label>
            <input id="tripFlyWin" class="input" placeholder="one fly to rule them all" />
          </div>
          <div>
            <label class="label">Lessons learned</label>
            <input id="tripLessons" class="input" placeholder="short" />
          </div>
        </div>

        <label class="label topGap">Recap</label>
        <textarea id="tripRecap" class="input area" placeholder="what happened, what you loved, what you’d do again"></textarea>

        <div class="row gap topGap">
          <button id="saveTripBtn" class="btn accent" type="button">Save Recap</button>
        </div>
      </details>
    </section>
  </main>

  <footer class="foot">
    <div class="muted">Offline-first. Data stays on device until you export.</div>
    <div class="muted" id="syncStatus">—</div>
  </footer>

  <!-- New Trip Overlay -->
  <div id="tripSheetOverlay" class="tripSheetOverlay" hidden aria-hidden="true">
    <div id="newTripForm" class="newTrip" hidden role="dialog" aria-modal="true" aria-label="Create new trip">
      <div class="grid2">
        <div class="span2">
          <label class="label">Trip Name</label>
          <input id="newTripName" class="input" placeholder="e.g., A Lifetime" />
        </div>
        <div>
          <label class="label">Where</label>
          <input id="newTripLocation" class="input" placeholder="e.g., West Branch Delaware" />
        </div>
        <div>
          <label class="label">Date</label>
          <input id="newTripDate" class="input" type="date" />
        </div>
        <div class="span2">
          <label class="label">Trip note (optional)</label>
          <input id="newTripDesc" class="input" placeholder="e.g., with Ryan • cold morning • high water" />
        </div>
      </div>

      <div class="row gap topGap">
        <button id="createTripBtn" class="btn accent" type="button">Save new trip</button>
        <button id="cancelTripBtn" class="btn ghost" type="button">Cancel</button>
      </div>

      <div class="hint">Create it fast now; edit anytime later.</div>
    </div>
  </div>

  <!-- Badge Toast -->
  <div id="badgeToast" class="toast hidden" role="status" aria-live="polite" aria-atomic="true">
    <div class="toastInner">
      <div class="toastText">
        <div class="toastTitle" id="badgeToastTitle"></div>
        <div class="toastSub" id="badgeToastSub"></div>
      </div>
      <button id="badgeToastClose" class="toastClose" aria-label="Close badge notification" type="button">✕</button>
    </div>
  </div>

  <!-- Collage Modal -->
  <div id="collageOverlay" class="overlay hidden"></div>
  <div id="collageModal" class="modal hidden" role="dialog" aria-modal="true">
    <div class="modalHead">
      <div>
        <div class="modalTitle">Trip Collage</div>
        <div class="modalSub" id="collageMeta">Top catches by length</div>
      </div>
      <button id="collageClose" class="btnGhost" type="button">Close</button>
    </div>

    <div class="modalBody">
      <div class="collageWrap">
        <img id="collagePreview" alt="Trip collage preview" />
      </div>
    </div>

    <div class="modalFoot">
      <button id="collageShare" class="btn ghost" type="button">Share</button>
      <button id="collageDownload" class="btn" type="button">Download PNG</button>
    </div>
  </div>

  <canvas id="collageCanvas" width="1400" height="1400" style="display:none;"></canvas>

  <!-- =========================
      Fly Modal (Add/Edit)
      (Moved ABOVE scripts so DOM refs exist when modules load)
  ========================= -->
  <div id="flyModalOverlay" class="overlay hidden" aria-hidden="true"></div>

  <section id="flyModal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true">
    <header class="modalHead">
      <div>
        <div id="flyModalTitle" class="modalTitle">Add Fly</div>
        <div id="flyModalSub" class="modalSub">Quick entry</div>
      </div>
      <button id="flyModalClose" class="btn ghost" type="button" aria-label="Close">✕</button>
    </header>

    <div class="modalBody">
      <div class="grid2">
        <div>
          <label class="label">Type</label>
          <select id="flyType" class="input">
            <option value="">—</option>
            <option value="nymph">Nymph</option>
            <option value="dry">Dry</option>
            <option value="wet">Wet</option>
            <option value="streamer">Streamer</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div>
          <label class="label">Pattern</label>
          <input id="flyPattern" class="input" placeholder="e.g., Zebra Midge" />
        </div>

        <div>
          <label class="label">Size</label>
          <input id="flySize" class="input" inputmode="numeric" placeholder="e.g., 16" />
        </div>

        <div>
          <label class="label">Qty</label>
          <input id="flyQty" class="input" inputmode="numeric" placeholder="e.g., 12" />
        </div>

        <div class="span2">
          <label class="label">Colors (optional)</label>
          <input id="flyColors" class="input" placeholder="black/silver, olive, tan..." />
        </div>

        <div class="span2">
          <label class="label">Photo (one per pattern)</label>
          <input id="flyPhoto" class="input" type="file" accept="image/*" />
          <div id="flyPhotoPreview" class="photoPreview hidden"></div>
        </div>
      </div>
    </div>

    <footer class="modalFoot">
      <button id="flyModalCancel" class="btn ghost" type="button">Cancel</button>
      <button id="addFlyBtn" class="btn accent" type="button">Save Fly</button>
    </footer>
  </section>

  <!-- Scripts -->
  <script src="vendor/jszip.min.js"></script>
  <script type="module" src="js/main.js?v=57"></script>
</body>
</html>
